(this["webpackJsonpit-incubator-todolist-ts"]=this["webpackJsonpit-incubator-todolist-ts"]||[]).push([[0],{103:function(t,e,n){},104:function(t,e,n){},128:function(t,e,n){"use strict";n.r(e);var a,i,c=n(3),o=n(0),s=n.n(o),r=n(9),d=n.n(r),l=(n(103),function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,183)).then((function(e){var n=e.getCLS,a=e.getFID,i=e.getFCP,c=e.getLCP,o=e.getTTFB;n(t),a(t),i(t),c(t),o(t)}))}),u=(n(104),n(172)),j=n(173),b=n(174),f=n(130),O=n(168),h=n(175),p=n(176),m=n(16),v=n(20),g=n(78),x=n.n(g).a.create({baseURL:"https://social-network.samuraijs.com/api/1.1/",withCredentials:!0,headers:{"API-KEY":"e12dcb15-1200-4ce1-bb28-bb99ac0ccb98"}}),C=function(){return x.get("todo-lists")},k=function(t){return x.post("todo-lists",{title:t})},T=function(t){return x.delete("todo-lists/".concat(t))},y=function(t,e){return x.put("todo-lists/".concat(t),{title:e})},A=function(t){return x.get("todo-lists/".concat(t,"/tasks"))},I=function(t,e){return x.delete("todo-lists/".concat(t,"/tasks/").concat(e))},w=function(t,e){return x.post("todo-lists/".concat(t,"/tasks"),{title:e})},S=function(t,e,n){return x.put("todo-lists/".concat(t,"/tasks/").concat(e),n)},L=function(t){return x.post("auth/login",t)},F=function(){return x.delete("auth/login")},E=function(){return x.get("auth/me")};!function(t){t[t.New=0]="New",t[t.InProgress=1]="InProgress",t[t.Completed=2]="Completed",t[t.Draft=3]="Draft"}(a||(a={})),function(t){t[t.Low=0]="Low",t[t.Middle=1]="Middle",t[t.Hi=2]="Hi",t[t.Urgently=3]="Urgently",t[t.Later=4]="Later"}(i||(i={}));var P=function(t,e){t.messages.length?e(H({error:t.messages[0]})):e(H({error:"Some error occurred"})),e(Z({status:"failed"}))},N=function(t,e){e(H({error:t.message?t.message:"Some error occurred"})),e(Z({status:"failed"}))},D=n(26),M=Object(D.b)({name:"auth",initialState:{isLoggedIn:!1},reducers:{setIsLoggedInAC:function(t,e){t.isLoggedIn=e.payload.value}}}),z=M.reducer,R=M.actions.setIsLoggedInAC,B=Object(D.b)({name:"app",initialState:{status:"idle",error:null,isInitialized:!1},reducers:{setAppErrorAC:function(t,e){t.error=e.payload.error},setAppStatusAC:function(t,e){t.status=e.payload.status},setAppInitializedAC:function(t,e){t.isInitialized=e.payload.value}}}),U=B.reducer,q=B.actions,H=q.setAppErrorAC,Z=q.setAppStatusAC,J=q.setAppInitializedAC,K=Object(D.b)({name:"todolists",initialState:[],reducers:{removeTodolistAC:function(t,e){var n=t.findIndex((function(t){return t.id===e.payload.id}));t.splice(n,1)},addTodolistAC:function(t,e){t.unshift(Object(v.a)(Object(v.a)({},e.payload.todolist),{},{filter:"all",entityStatus:"idle"}))},changeTodolistTitleAC:function(t,e){var n=t.findIndex((function(t){return t.id===e.payload.id}));t[n].title=e.payload.title},changeTodolistFilterAC:function(t,e){var n=t.findIndex((function(t){return t.id===e.payload.id}));t[n].filter=e.payload.filter},changeTodolistEntityStatusAC:function(t,e){var n=t.findIndex((function(t){return t.id===e.payload.id}));t[n].entityStatus=e.payload.status},setTodolistsAC:function(t,e){return e.payload.todolists.map((function(t){return Object(v.a)(Object(v.a)({},t),{},{filter:"all",entityStatus:"idle"})}))}}}),_=K.reducer,G=K.actions,V=G.removeTodolistAC,Y=G.addTodolistAC,$=G.changeTodolistTitleAC,Q=G.changeTodolistFilterAC,W=G.changeTodolistEntityStatusAC,X=G.setTodolistsAC,tt=Object(D.b)({name:"tasks",initialState:{},reducers:{removeTaskAC:function(t,e){var n=t[e.payload.todolistId],a=n.findIndex((function(t){return t.id===e.payload.taskId}));a>-1&&n.splice(a,1)},addTaskAC:function(t,e){t[e.payload.task.todoListId].unshift(e.payload.task)},updateTaskAC:function(t,e){var n=t[e.payload.todolistId],a=n.findIndex((function(t){return t.id===e.payload.taskId}));a>-1&&(n[a]=Object(v.a)(Object(v.a)({},n[a]),e.payload.model))},setTasksAC:function(t,e){t[e.payload.todolistId]=e.payload.tasks}},extraReducers:function(t){t.addCase(Y,(function(t,e){t[e.payload.todolist.id]=[]})),t.addCase(V,(function(t,e){delete t[e.payload.id]})),t.addCase(X,(function(t,e){e.payload.todolists.forEach((function(e){t[e.id]=[]}))}))}}),et=tt.reducer,nt=tt.actions,at=nt.removeTaskAC,it=nt.addTaskAC,ct=nt.updateTaskAC,ot=nt.setTasksAC,st=function(t,e,n){return function(a,i){var c=i().tasks[n].find((function(e){return e.id===t}));if(c){var o=Object(v.a)({deadline:c.deadline,description:c.description,priority:c.priority,startDate:c.startDate,title:c.title,status:c.status},e);S(n,t,o).then((function(i){if(0===i.data.resultCode){var c=ct({taskId:t,model:e,todolistId:n});a(c)}else P(i.data,a)})).catch((function(t){N(t,a)}))}else console.warn("task not found in the state")}},rt=n(169),dt=n(129),lt=n(43),ut=n(177),jt=n(165),bt=n(166),ft=s.a.memo((function(t){var e=t.addItem,n=t.disabled,a=void 0!==n&&n;console.log("AddItemForm called");var i=Object(o.useState)(""),s=Object(lt.a)(i,2),r=s[0],d=s[1],l=Object(o.useState)(null),u=Object(lt.a)(l,2),j=u[0],b=u[1],f=function(){""!==r.trim()?(e(r),d("")):b("Title is required")};return Object(c.jsxs)("div",{children:[Object(c.jsx)(ut.a,{variant:"outlined",disabled:a,error:!!j,value:r,onChange:function(t){d(t.currentTarget.value)},onKeyPress:function(t){null!==j&&b(null),13===t.charCode&&f()},label:"Title",helperText:j}),Object(c.jsx)(jt.a,{color:"primary",onClick:f,disabled:a,children:Object(c.jsx)(bt.a,{})})]})})),Ot=n(86),ht=s.a.memo((function(t){console.log("EditableSpan called");var e=Object(o.useState)(!1),n=Object(lt.a)(e,2),a=n[0],i=n[1],s=Object(o.useState)(t.value),r=Object(lt.a)(s,2),d=r[0],l=r[1];return a?Object(c.jsx)(ut.a,{value:d,onChange:function(t){l(t.currentTarget.value)},autoFocus:!0,onBlur:function(){i(!1),t.onChange(d)}}):Object(c.jsx)("span",{onDoubleClick:function(){i(!0),l(t.value)},children:t.value})})),pt=n(167),mt=n(179),vt=s.a.memo((function(t){var e=t.task,n=t.todolistId,i=t.changeTaskStatus,s=t.changeTaskTitle,r=t.removeTask,d=Object(o.useCallback)((function(){return r(e.id,n)}),[r,e.id,n]),l=Object(o.useCallback)((function(t){var c=t.currentTarget.checked;i(e.id,c?a.Completed:a.New,n)}),[i,e.id,n]),u=Object(o.useCallback)((function(t){s(e.id,t,n)}),[s,e.id,n]);return Object(c.jsxs)("div",{className:e.status===a.Completed?"is-done":"",children:[Object(c.jsx)(mt.a,{checked:e.status===a.Completed,color:"primary",onChange:l}),Object(c.jsx)(ht,{value:e.title,onChange:u}),Object(c.jsx)(jt.a,{onClick:d,children:Object(c.jsx)(pt.a,{})})]},e.id)})),gt=s.a.memo((function(t){var e=t.demo,n=void 0!==e&&e,i=Object(Ot.a)(t,["demo"]);console.log("Todolist called");var s=i.todolist,r=i.tasks,d=i.changeFilter,l=i.addTask,u=i.changeTaskStatus,j=i.changeTaskTitle,b=i.removeTask,f=i.removeTodolist,h=i.changeTodolistTitle,p=Object(m.b)();Object(o.useEffect)((function(){if(!n){var t,e=(t=s.id,function(e){e(Z({status:"loading"})),A(t).then((function(n){var a=n.data.items;e(ot({tasks:a,todolistId:t})),e(Z({status:"succeeded"}))}))});p(e)}}),[n,p,s.id]);var v=Object(o.useCallback)((function(t){l(t,s.id)}),[l,s.id]),g=Object(o.useCallback)((function(t){h(s.id,t)}),[s.id,h]),x=Object(o.useCallback)((function(){return d("all",s.id)}),[s.id,d]),C=Object(o.useCallback)((function(){return d("active",s.id)}),[s.id,d]),k=Object(o.useCallback)((function(){return d("completed",s.id)}),[s.id,d]),T=r;return"active"===s.filter&&(T=r.filter((function(t){return t.status===a.New}))),"completed"===s.filter&&(T=r.filter((function(t){return t.status===a.Completed}))),Object(c.jsxs)("div",{children:[Object(c.jsxs)("h3",{children:[Object(c.jsx)(ht,{value:s.title,onChange:g}),Object(c.jsx)(jt.a,{onClick:function(){f(s.id)},disabled:"loading"===s.entityStatus,children:Object(c.jsx)(pt.a,{})})]}),Object(c.jsx)(ft,{addItem:v,disabled:"loading"===s.entityStatus}),Object(c.jsx)("div",{children:T.map((function(t){return Object(c.jsx)(vt,{task:t,todolistId:s.id,removeTask:b,changeTaskTitle:j,changeTaskStatus:u},t.id)}))}),Object(c.jsxs)("div",{style:{paddingTop:"10px"},children:[Object(c.jsx)(O.a,{variant:"all"===s.filter?"outlined":"text",onClick:x,color:"default",children:"All"}),Object(c.jsx)(O.a,{variant:"active"===s.filter?"outlined":"text",onClick:C,color:"primary",children:"Active"}),Object(c.jsx)(O.a,{variant:"completed"===s.filter?"outlined":"text",onClick:k,color:"secondary",children:"Completed"})]})]})})),xt=n(13),Ct=function(t){var e=t.demo,n=void 0!==e&&e,a=Object(m.c)((function(t){return t.todolists})),i=Object(m.c)((function(t){return t.tasks})),s=Object(m.c)((function(t){return t.auth.isLoggedIn})),r=Object(m.b)();Object(o.useEffect)((function(){if(!n&&s){var t=function(t){t(Z({status:"loading"})),C().then((function(e){t(X({todolists:e.data})),t(Z({status:"succeeded"}))}))};r(t)}}),[n,r,s]);var d=Object(o.useCallback)((function(t,e){var n=function(t,e){return function(n){I(e,t).then((function(a){var i=at({taskId:t,todolistId:e});n(i)}))}}(t,e);r(n)}),[r]),l=Object(o.useCallback)((function(t,e){var n=function(t,e){return function(n){n(Z({status:"loading"})),w(e,t).then((function(t){if(0===t.data.resultCode){var e=t.data.data.item,a=it({task:e});n(a),n(Z({status:"succeeded"}))}else P(t.data,n)})).catch((function(t){N(t,n)}))}}(t,e);r(n)}),[r]),u=Object(o.useCallback)((function(t,e,n){var a=st(t,{status:e},n);r(a)}),[r]),j=Object(o.useCallback)((function(t,e,n){var a=st(t,{title:e},n);r(a)}),[r]),b=Object(o.useCallback)((function(t,e){var n=Q({id:e,filter:t});r(n)}),[r]),f=Object(o.useCallback)((function(t){var e,n=(e=t,function(t){t(Z({status:"loading"})),t(W({id:e,status:"loading"})),T(e).then((function(n){t(V({id:e})),t(Z({status:"succeeded"}))}))});r(n)}),[r]),O=Object(o.useCallback)((function(t,e){var n=function(t,e){return function(n){y(t,e).then((function(a){n($({id:t,title:e}))}))}}(t,e);r(n)}),[r]),h=Object(o.useCallback)((function(t){var e=function(t){return function(e){e(Z({status:"loading"})),k(t).then((function(t){e(Y({todolist:t.data.data.item})),e(Z({status:"succeeded"}))}))}}(t);r(e)}),[r]);return s?Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(rt.a,{container:!0,style:{padding:"20px"},children:Object(c.jsx)(ft,{addItem:h})}),Object(c.jsx)(rt.a,{container:!0,spacing:3,children:a.map((function(t){var e=i[t.id];return Object(c.jsx)(rt.a,{item:!0,children:Object(c.jsx)(dt.a,{style:{padding:"10px"},children:Object(c.jsx)(gt,{todolist:t,tasks:e,removeTask:d,changeFilter:b,addTask:l,changeTaskStatus:u,removeTodolist:f,changeTaskTitle:j,changeTodolistTitle:O,demo:n})})},t.id)}))})]}):Object(c.jsx)(xt.a,{to:"/login"})},kt=n(181),Tt=n(178);function yt(t){return Object(c.jsx)(Tt.a,Object(v.a)({elevation:6,variant:"filled"},t))}function At(){var t=Object(m.c)((function(t){return t.app.error})),e=Object(m.b)(),n=function(t,n){"clickaway"!==n&&e(H({error:null}))},a=null!==t;return Object(c.jsx)(kt.a,{open:a,autoHideDuration:6e3,onClose:n,children:Object(c.jsx)(yt,{onClose:n,severity:"error",children:t})})}var It=n(182),wt=n(164),St=n(170),Lt=n(171),Ft=n(85),Et=function(){var t=Object(m.b)(),e=Object(m.c)((function(t){return t.auth.isLoggedIn})),n=Object(Ft.a)({initialValues:{email:"",password:"",rememberMe:!1},validate:function(t){var e={};return t.email?/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i.test(t.email)||(e.email="Invalid email address"):e.email="Required",t.password?t.password.length>20&&(e.password="Must be 20 characters or less"):e.password="Required",e},onSubmit:function(e){var a;t((a=e,function(t){t(Z({status:"loading"})),L(a).then((function(e){0===e.data.resultCode?(t(R({value:!0})),t(Z({status:"succeeded"}))):P(e.data,t)})).catch((function(e){N(e,t)}))})),n.resetForm()}});return e?Object(c.jsx)(xt.a,{to:"/"}):Object(c.jsx)(rt.a,{container:!0,justify:"center",children:Object(c.jsx)(rt.a,{item:!0,xs:4,children:Object(c.jsx)("form",{onSubmit:n.handleSubmit,children:Object(c.jsxs)(It.a,{children:[Object(c.jsxs)(wt.a,{children:[Object(c.jsxs)("p",{children:["To log in get registered",Object(c.jsx)("a",{href:"https://social-network.samuraijs.com/",target:"_blank",rel:"noreferrer",children:"here"})]}),Object(c.jsx)("p",{children:"or use common test account credentials:"}),Object(c.jsx)("p",{children:"Email: free@samuraijs.com"}),Object(c.jsx)("p",{children:"Password: free"})]}),Object(c.jsxs)(St.a,{children:[Object(c.jsx)(ut.a,Object(v.a)({label:"Email",margin:"normal"},n.getFieldProps("email"))),n.touched.email&&n.errors.email?Object(c.jsx)("div",{style:{color:"red"},children:n.errors.email}):null,Object(c.jsx)(ut.a,Object(v.a)({type:"password",label:"Password",margin:"normal"},n.getFieldProps("password"))),n.touched.password&&n.errors.password?Object(c.jsx)("div",{style:{color:"red"},children:n.errors.password}):null,Object(c.jsx)(Lt.a,Object(v.a)({label:"Remember me",control:Object(c.jsx)(mt.a,{}),checked:n.values.rememberMe},n.getFieldProps("rememberMe"))),Object(c.jsx)(O.a,{type:"submit",variant:"contained",color:"secondary",children:"Login"})]})]})})})})};var Pt=function(t){var e=t.demo,n=void 0!==e&&e,a=Object(m.c)((function(t){return t.app.status})),i=Object(m.c)((function(t){return t.app.isInitialized})),s=Object(m.c)((function(t){return t.auth.isLoggedIn})),r=Object(m.b)();Object(o.useEffect)((function(){r((function(t){E().then((function(e){0===e.data.resultCode&&t(R({value:!0})),t(J({value:!0}))}))}))}),[r]);var d=Object(o.useCallback)((function(){r((function(t){t(Z({status:"loading"})),F().then((function(e){0===e.data.resultCode?(t(R({value:!1})),t(Z({status:"succeeded"}))):P(e.data,t)})).catch((function(e){N(e,t)}))}))}),[r]);return i?Object(c.jsxs)("div",{className:"App",children:[Object(c.jsx)(At,{}),Object(c.jsxs)(j.a,{position:"static",children:[Object(c.jsxs)(b.a,{className:"headerBar",children:[Object(c.jsx)(f.a,{variant:"h6",children:"Todos"}),s&&Object(c.jsx)(O.a,{variant:"contained",color:"secondary",onClick:d,children:"Log out"})]}),"loading"===a&&Object(c.jsx)(h.a,{})]}),Object(c.jsx)(p.a,{fixed:!0,children:Object(c.jsxs)(xt.d,{children:[Object(c.jsx)(xt.b,{exact:!0,path:"/",render:function(){return Object(c.jsx)(Ct,{demo:n})}}),Object(c.jsx)(xt.b,{path:"/login",render:function(){return Object(c.jsx)(Et,{})}}),Object(c.jsx)(xt.b,{path:"*",render:function(){return Object(c.jsx)("h1",{children:"404: PAGE NOT FOUND"})}}),Object(c.jsx)(xt.a,{from:"*",to:"/404"})]})})]}):Object(c.jsx)("div",{style:{position:"fixed",top:"30%",textAlign:"center",width:"100%"},children:Object(c.jsx)(u.a,{})})},Nt=n(52),Dt=n(46),Mt=Object(Nt.b)({tasks:et,todolists:_,app:U,auth:z}),zt=Object(D.a)({reducer:Mt,middleware:function(t){return t().prepend(Dt.a)}});window.store=zt;var Rt=n(45);d.a.render(Object(c.jsx)(m.a,{store:zt,children:Object(c.jsx)(Rt.a,{children:Object(c.jsx)(Pt,{})})}),document.getElementById("root")),l()}},[[128,1,2]]]);
//# sourceMappingURL=main.7b897971.chunk.js.map